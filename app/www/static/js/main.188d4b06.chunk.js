(this["webpackJsonpfresh-react-app"]=this["webpackJsonpfresh-react-app"]||[]).push([[0],{112:function(e,t,a){},189:function(e,t,a){},192:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(42),s=a.n(c),o=(a(112),a(86)),i=a(18),u=a.n(i),l=a(32),d=a(28),p=a(15),h=a(7),b=a(8),j=a(11),f=a(10),v=a(60),_=a.n(v),O=a(3),m=function(e){Object(j.a)(a,e);var t=Object(f.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(b.a)(a,[{key:"_componentDidMount",value:function(){}},{key:"componentDidMount",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._componentDidMount();case 2:window.scrollTo(0,0);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_render",value:function(){return Object(O.jsxs)("h1",{children:["Please implement ",Object(O.jsx)("code",{children:"_render()"})]})}},{key:"render",value:function(){return Object(O.jsx)("div",{className:"page",children:this._render()})}}]),a}(function(e){Object(j.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(h.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).___state_update_locks___=new _.a,e.___state_update_in_progress=!1,e.onChangeHandlerGenerator.bind(Object(d.a)(e)),e.setInputValue=e.setInputValue.bind(Object(d.a)(e)),e}return Object(b.a)(a,[{key:"___lock_state_update___",value:function(){var e=this;return new Promise((function(t){e.___state_update_locks___.enqueue(t),e.___state_update_in_progress||(e.___state_update_in_progress=!0,e.___process_next_update___())}))}},{key:"___process_next_update___",value:function(){var e=this.___state_update_locks___.peek();e?e():this.___state_update_in_progress=!1}},{key:"___unlock_state_update___",value:function(){this.___state_update_locks___.dequeue(),this.___process_next_update___()}},{key:"updateState",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.___lock_state_update___();case 2:return a=Object(p.a)(Object(p.a)({},this.state||{}),t),e.next=5,this.setState(a);case 5:this.___unlock_state_update___();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setInputValue",value:function(){var e=Object(l.a)(u.a.mark((function e(t,a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.state.values)[t]=a,e.next=4,this.updateState({values:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"onChangeHandlerGenerator",value:function(e){return function(e){var t;t="object"==typeof e?e.target.value:e;var a=(this.componentInstance.state||{}).values||{};a[this.name]=t,this.componentInstance.updateState({values:a})}.bind({componentInstance:this,name:e})}},{key:"render",value:function(){return Object(O.jsxs)("p",{children:["Please implement ",Object(O.jsx)("code",{children:"render()"})]})}}]),a}(r.a.Component)),g=a(45),x=a(225),y=a(226),k=a(223),w=a(224),D=a(220),T=a(85),S=a.n(T),C=(a(121),a(102)),F=Object(C.a)({"--side-margin":"10px","& b":{margin:"0 var(--side-margin)",fontSize:25},"& input":{background:"grey",color:"white",border:"none",margin:"0 var(--side-margin)",width:"calc(100% - 2 * var(--side-margin))",boxShadow:"0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 3px 1px -2px rgba(0, 0, 0, 0.12), 0 1px 5px 0 rgba(0, 0, 0, 0.2)",padding:"5px 0",textAlign:"center",cursor:"pointer"}}),I=function(e){Object(j.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(h.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={values:{}},e.updateFrom=e.updateFrom.bind(Object(d.a)(e)),e.updateTo=e.updateTo.bind(Object(d.a)(e)),e}return Object(b.a)(a,[{key:"updateParent",value:function(){if(this.props.onChange){var e=this.state.values,t=e.from,a=void 0===t?this.props.from:t,n=e.to,r=void 0===n?this.props.to:n;this.props.onChange({from:a,to:r})}}},{key:"updateFrom",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(p.a)(Object(p.a)({},this.state.values),{},{from:t}),e.next=3,this.updateState({values:a});case 3:this.updateParent();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateTo",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(p.a)(Object(p.a)({},this.state.values),{},{to:t}),e.next=3,this.updateState({values:a});case 3:this.updateParent();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.from,a=void 0===t?this.state.values.from||new Date:t,n=e.to,r=void 0===n?this.state.values.to||new Date:n;return Object(O.jsx)("div",{children:Object(O.jsxs)(D.a,{container:!0,style:{fontFamily:"Arial"},children:[Object(O.jsxs)(D.a,{item:!0,xs:6,sm:6,className:F,children:[Object(O.jsx)("b",{children:"FROM"}),Object(O.jsx)("br",{}),Object(O.jsx)(S.a,{placeholder:"From",selected:a,onChange:this.updateFrom})]}),Object(O.jsxs)(D.a,{item:!0,xs:6,sm:6,className:F,children:[Object(O.jsx)("b",{children:"TO"}),Object(O.jsx)("br",{}),Object(O.jsx)(S.a,{placeholder:"To",selected:r,onChange:this.updateTo})]})]})})}}]),a}(g.a),M=a(67),P=a(99);var A=Object(P.a)((function(e,t){var a=t.type,n=t.payload;switch(a){case"update-data":return function(e,t){var a=Object(p.a)(Object(p.a)({},e.data),t);return Object(p.a)(Object(p.a)({},e),{},{data:a})}(e,n);default:return e}}),{}),L=a(83),E=a.n(L);function R(){return(R=Object(l.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("/api/system-data");case 2:t=e.sent,a=t.data,n={type:"update-data",payload:a},A.dispatch(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N={fetchData:function(){return R.apply(this,arguments)}},z=a(83);0===window.location.href.indexOf("file://")&&z.interceptors.request.use((function(e){return e.url="https://water-management.herokuapp.com"+e.url,e}));var B=z,H=a(101),q=a(222);function V(e){return e<10?"0"+e:e.toString()}var G=function(e){Object(j.a)(a,e);var t=Object(f.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(b.a)(a,[{key:"_componentDidMount",value:function(){this.fetchDataTimer=setInterval(this.fetchData.bind(this),3e3),this.fetchData()}},{key:"fetchData",value:function(){N.fetchData()}},{key:"componentWillUnmount",value:function(){clearInterval(this.fetchDataTimer)}},{key:"_render",value:function(){var e=this.props.data,t=e.water_level/2e3*100;return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{style:{paddingTop:"var(--navbar-height)"},children:[Object(O.jsx)(W,{level:t}),Object(O.jsx)(q.a,{}),Object(O.jsx)(U,{data:Object(p.a)(Object(p.a)({},e),{},{water_level_percentage:t})}),Object(O.jsx)(K,{})]})})}}]),a}(m);var J=Object(M.b)((function(e){var t=e.data;return{data:void 0===t?{}:t}}))(G);function W(e){var t=e.level;return Object(O.jsxs)("div",{style:{margin:20},children:[Object(O.jsxs)("span",{style:{display:"block",textAlign:"center",color:"grey",fontSize:30,marginBottom:20},children:["Tank Level (",t,"%)"]}),Object(O.jsx)("div",{style:{border:"1px solid #ccc",padding:0,height:30},children:Object(O.jsx)("div",{style:{background:"var(--secondary-color)",height:30,display:"inline-block",width:"".concat(t,"%"),margin:0,padding:0}})})]})}function Y(e){var t=e.data,a=e.label;return Object(O.jsxs)(k.a,{children:[Object(O.jsx)(w.a,{children:Object(O.jsx)("b",{children:a})}),Object(O.jsx)(w.a,{children:t})]})}function U(e){var t=e.data,a=t.outflow_rate,n=t.inflow_rate,r=t.leakage,c=t.water_level,s=t.water_level_percentage,o="".concat(c," litres (").concat(s,"%)");return Object(O.jsx)(x.a,{children:Object(O.jsxs)(y.a,{children:[Object(O.jsx)(Y,{label:"Level",data:o}),Object(O.jsx)(Y,{label:"Outflow rate",data:a}),Object(O.jsx)(Y,{label:"Inflow rate",data:n}),Object(O.jsx)(Y,{label:"Leakage",data:r?"YES":"NO"})]})})}var K=function(e){Object(j.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(h.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={from:new Date,to:new Date,fromTimeStamp:(new Date).getTime(),toTimeStamp:(new Date).getTime()+864e5+1,data:{datasets:[],labels:[]}},e.onRangeChange=e.onRangeChange.bind(Object(d.a)(e)),e}return Object(b.a)(a,[{key:"onRangeChange",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var a,n,r,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.from,n=t.to,a=new Date(a).getTime(),n=new Date(n).getTime(),a!==n){e.next=6;break}return e.abrupt("return",alert("Invalid range."));case 6:return a>n&&(r=a,a=n,n=r),c=n+864e5-1,s=a,e.next=11,this.updateState({from:a,to:n,toTimeStamp:c,fromTimeStamp:s});case 11:return e.next=13,this.fetchData();case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchData",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,a,n,r,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,a=t.fromTimeStamp,n=t.toTimeStamp,e.prev=1,e.next=4,B.get("/api/system-data/history?from=".concat(a,"&to=").concat(n));case 4:return r=e.sent,c=this.prepareDataForChart(r.data),e.next=8,this.updateState({data:c});case 8:e.next=16;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),s=e.t0.response,console.log(s),alert("Something bad happened.");case 16:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"prepareDataForChart",value:function(e){var t={data:[],label:"Water Level",backgroundColor:"green",borderColor:"green",lineTension:.4},a={data:[],label:"Inflow rate",backgroundColor:"blue",borderColor:"blue",lineTension:.4},n={data:[],label:"Outflow Rate",backgroundColor:"red",borderColor:"red",lineTension:.4},r=[],c=[t,n,a];return console.log(e),e.forEach((function(e){var c=e.water_level,s=e.created_at,o=e.inflow_rate,i=e.outflow_rate;r.push(function(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth(),r=t.getDay(),c=V(t.getMinutes()),s=V(t.getSeconds()),o=V(t.getHours());return"".concat(a,"-").concat(n,"-").concat(r,"@").concat(o,":").concat(c,":").concat(s)}(s)),console.log(s),n.data.push(i),t.data.push(c),a.data.push(o)})),{datasets:c,labels:r}}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{style:{margin:"20px 0"},children:Object(O.jsx)(I,{onChange:this.onRangeChange,from:this.state.from,to:this.state.to})}),Object(O.jsx)(H.a,{data:this.state.data})]})}}]),a}(g.a),Q=a(219),X=a(100),Z=a.n(X);function $(){var e=document.getElementById("appbar").offsetHeight+"px";document.documentElement.style.setProperty("--navbar-height",e)}var ee=function(e){Object(j.a)(a,e);var t=Object(f.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(b.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",$),$()}},{key:"render",value:function(){return Object(O.jsx)(Q.a,{style:{padding:10,position:"fixed"},id:"appbar",children:Object(O.jsx)("div",{style:{textAlign:"center"},children:Object(O.jsx)(Z.a,{fontSize:"large",className:"rotate"})})})}}]),a}(g.a),te=(a(189),a(19));te.d.register(te.c,te.i,te.k,te.h,te.o,te.p,te.f);var ae=function(){return Object(O.jsxs)(M.a,{store:A,children:[Object(O.jsx)(ee,{}),Object(O.jsx)(o.b,{router:"hash",children:Object(O.jsx)(o.a,{path:"/",component:J})})]})},ne=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,227)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};s.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(ae,{})}),document.getElementById("root")),ne()}},[[192,1,2]]]);
//# sourceMappingURL=main.188d4b06.chunk.js.map